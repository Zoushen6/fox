(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"0229":function(t,e,i){"use strict";i("52ec")},2460:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{class:t.headerClass,attrs:{title:t.title,visible:t.visibility,width:t.width+"px",center:t.center,"custom-class":t.customClass,"append-to-body":t.appendToBody,modal:t.modal,"close-on-click-modal":t.clickModal,"before-close":function(e){t.$emit("close"),e()}},on:{"update:visible":function(e){t.visibility=e},open:function(e){return t.$emit("open")},opened:function(){t.$emit("opened")},closed:function(){t.$emit("after-close")}}},[t._t("title",null,{slot:"title"}),t._t("default"),t.showFooter?i("div",{staticClass:"dialog-footer text-right",attrs:{slot:"footer",name:"footer"},slot:"footer"},[t.showSubmit?i("el-button",{class:t.isReverse?"reverse":"",attrs:{type:"primary",size:"small"},on:{click:function(e){return t.$emit("submit")}}},[t._v(t._s(t.confirmText))]):t._e(),t.showCancel?i("el-button",{attrs:{size:"small"},on:{click:t.cancel}},[t._v("取 消")]):t._e()],1):t._e()],2)},a=[],n=(i("9664"),{name:"CustomizedDialog",props:{visible:{type:Boolean,default:!1},center:{type:Boolean,default:!1},showFooter:{type:Boolean,default:!1},showSubmit:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},appendToBody:{type:Boolean,default:!1},isReverse:{type:Boolean,default:!1},title:{type:String,default:"提示"},confirmText:{type:String,default:"确 认"},customClass:{type:String},width:{type:Number,default:420},modal:{type:Boolean,default:!0},clickModal:{type:Boolean,default:!0}},watch:{visibility:function(t){this.$emit("update:visible",t)},visible:function(t){this.visibility=t}},computed:{headerClass:function(){return this.title?"dialog-header-border":""}},data:function(){return{visibility:!1}},methods:{cancel:function(){this.visibility=!1,this.$emit("cancel")}}}),s=n,r=(i("0229"),i("cba8")),l=Object(r["a"])(s,o,a,!1,null,"ac5e35c4",null);e["default"]=l.exports},"491d":function(t,e,i){},"52ec":function(t,e,i){},"65e3":function(t,e,i){},"673f":function(t,e,i){"use strict";i("65e3")},"6e27":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-date-picker",{attrs:{type:"daterange",align:t.align,"unlink-panels":"",clearable:t.clearable,size:t.size,"range-separator":t.rangeSeparator,"start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,"value-format":t.valueFormat,"picker-options":t.pickerOptions},on:{change:function(e){t.$emit("change",[new Date(e[0]).getTime(),new Date(e[1]).getTime()])}},model:{value:t.dateLocal,callback:function(e){t.dateLocal=e},expression:"dateLocal"}})},a=[],n=(i("9664"),i("00fe"),i("87c5"),i("11e1"),i("7eeb")),s={name:"CustomizedTimePicker",props:{date:{type:Array},clearable:{type:Boolean,default:!1},align:{type:String,default:"left"},size:{type:String},rangeSeparator:{type:String,default:"至"},startPlaceholder:{type:String,default:"开始日期"},endPlaceholder:{type:String,default:"结束日期"},valueFormat:{type:String,default:"yyyy-MM-dd"},minDate:{type:Number,default:null},maxDate:{type:Number,default:null},showShortcutsSetting:{type:Boolean,default:!0},shortcutsSetting:{type:Array,default:function(){return["lastSeven","lastFifteen","lastThirty"]}}},computed:{dateLocal:{get:function(){if(this.date.length)return[this.getNewDay(this.date[0]),this.getNewDay(this.date[1])]},set:function(t){this.$emit("update:date",[new Date(t[0]).getTime(),new Date(t[1]).getTime()])}},pickerOptions:function(){var t=this.getShortcuts(this.shortcutsSetting),e=this.minDate,i=this.maxDate;return{disabledDate:function(t){return null!==e&&t.getTime()<new Date-864e5*e||null!==i&&t.getTime()>new Date-864e5*i},shortcuts:this.showShortcutsSetting?t:null}}},data:function(){var t=this;return{shortcuts:{today:{text:"今天",onClick:function(t){t.$emit("pick",Object(n["d"])(1,0))}},yesterday:{text:"昨天",onClick:function(t){t.$emit("pick",Object(n["d"])(1,1))}},lastSeven:{text:"最近7天",onClick:function(e){e.$emit("pick",Object(n["d"])(7,t.maxDate))}},lastFifteen:{text:"最近15天",onClick:function(e){e.$emit("pick",Object(n["d"])(15,t.maxDate))}},lastThirty:{text:"最近30天",onClick:function(e){e.$emit("pick",Object(n["d"])(30,t.maxDate))}},lastNinety:{text:"最近90天",onClick:function(e){e.$emit("pick",Object(n["d"])(90,t.maxDate))}},curWeek:{text:"本周",onClick:function(t){t.$emit("pick",Object(n["b"])())}},lastWeek:{text:"上周",onClick:function(t){t.$emit("pick",Object(n["e"])())}},curMonth:{text:"本月",onClick:function(t){t.$emit("pick",Object(n["a"])())}},lastMonth:{text:"上月",onClick:function(t){t.$emit("pick",Object(n["c"])())}}}}},methods:{getNewDay:function(t){var e=t?new Date(t):new Date,i=e.getMonth()+1,o=e.getDate(),a=function(t){return t<10?"0"+t:t};return e.getFullYear()+"-"+a(i)+"-"+a(o)},getShortcuts:function(t){var e=this,i=[];return t.forEach((function(t){i.push(e.shortcuts[t])})),i}}},r=s,l=i("cba8"),c=Object(l["a"])(r,o,a,!1,null,"ed5c471e",null);e["default"]=c.exports},"7b65":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("customized-dialog",{staticClass:"text-dialog",attrs:{visible:t.dialogVisible,title:t.title,"show-footer":t.showFooter,"is-reverse":t.isReverse,width:500},on:{cancel:t.closeDialog,submit:function(e){return t.$emit("success")},close:t.closeDialog}},[i("p",{staticClass:"text-desc",class:t.textClass},[t._v(t._s(t.text))])])},a=[],n=i("6b9a"),s={name:"TextDialog",mixins:[n["a"]],props:{showFooter:{type:Boolean,default:!1},showCancel:{type:Boolean,default:!1},isReverse:{type:Boolean,default:!1},title:{type:String,default:"提示"},textClass:{type:String,default:""},text:{type:String,default:""}}},r=s,l=(i("673f"),i("cba8")),c=Object(l["a"])(r,o,a,!1,null,"cf105f56",null);e["a"]=c.exports},b671:function(t,e,i){"use strict";i("491d")},ddc0:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"top-bar"},[o("div",{staticClass:"f-r top-menu"},[t.username?o("el-popover",{attrs:{placement:"top-end",width:"96",trigger:"hover","popper-class":"disable-popper-padding"}},[t._l(t.authMenu,(function(e,i){return o("el-button",{key:i,on:{click:function(i){return t.chooseStrategy(e)}}},[o("svg-icon",{staticClass:"menu-icon",attrs:{"icon-name":e.iconfont}}),t._v(t._s(e.title)+" ")],1)})),o("div",{staticClass:"username vertical-align-top",attrs:{slot:"reference",title:t.name?t.name:t.username},slot:"reference"},[o("span",{staticClass:"icon-user-head"},[o("img",{attrs:{src:i("32b0"),alt:""}}),t._v(t._s(t.name?t.name:t.username)+" ")])])],2):t._e()],1),o("customized-dialog",{staticClass:"customized-dialog",attrs:{title:t.pwdDialogTitle,visible:t.pwdDialogVisible,"show-footer":!0,"append-to-body":!0,width:600},on:{cancel:function(e){return t.resetDialog("pwdForm")},submit:function(e){return t.submitModify("pwdForm")},close:function(e){return t.resetDialog("pwdForm")}}},[o("el-form",{ref:"pwdForm",staticClass:"dialog-form",attrs:{model:t.pwdForm,rules:t.pwdRules,"label-width":"95px","label-position":"right"}},[o("el-form-item",{attrs:{label:"当前密码",prop:"now_passwd"}},[o("el-input",{attrs:{"show-password":""},model:{value:t.pwdForm.now_passwd,callback:function(e){t.$set(t.pwdForm,"now_passwd",e)},expression:"pwdForm.now_passwd"}})],1),o("el-form-item",{attrs:{label:"新密码",prop:"passwd"}},[o("el-input",{attrs:{"show-password":""},model:{value:t.pwdForm.passwd,callback:function(e){t.$set(t.pwdForm,"passwd",e)},expression:"pwdForm.passwd"}})],1),o("el-form-item",{attrs:{label:"确认密码",prop:"passwd_repeat"}},[o("el-input",{attrs:{"show-password":""},model:{value:t.pwdForm.passwd_repeat,callback:function(e){t.$set(t.pwdForm,"passwd_repeat",e)},expression:"pwdForm.passwd_repeat"}})],1)],1)],1),o("customized-dialog",{staticClass:"customized-dialog",attrs:{title:"退出登录",visible:t.logoutDialogVisible,"show-footer":!0,"append-to-body":!0,width:507},on:{cancel:t.resetDialog,submit:t.subLogout,close:t.resetDialog}},[o("p",[t._v("确定退出登录？")])])],1)},a=[],n=i("799e"),s=i("6afb"),r=(i("e186"),i("665c"),i("d6b0"),i("fd72"),i("cddc"),i("87c5"),i("00fe"),i("11e1"),i("a57c"),i("7736")),l=i("fec4"),c=i("6b9a"),u=i("d4a6"),d={name:"topBar",mixins:[c["a"],u["a"]],data:function(){var t=this,e=function(t,e,i){var o=/^1[34578]\d{9}$/;o.test(e)||""==e?i():i(new Error("请输入正确的手机号"))},i=function(t,e,i){var o=/^\S{8,}$/;o.test(e)?i():i(new Error("密码不少于8位"))},o=function(e,i,o){t.pwdForm.passwd==i?o():o(new Error("两次输入密码不一致"))};return{logoutDialogVisible:!1,pwdDialogVisible:!1,pwdDialogTitle:"",pwdForm:{now_passwd:"",passwd:"",passwd_repeat:""},profileRules:{tel:[{required:!1,validator:e}]},pwdRules:{now_passwd:[{required:!0,message:"请输入当前密码"}],passwd:[{required:!0,validator:i}],passwd_repeat:[{required:!0,validator:o}]},authMenu:null,messageList:[],currentPage:1,total:0,strategy:{password:this.modifyPassword,exit:this.logout,"download-center":this.routeToDownloadCenter},notificationCnt:0,notificationTimer:null}},created:function(){this.authMenu=l["a"]},computed:Object(s["a"])({},Object(r["b"])({username:function(t){return t.global.username},name:function(t){return t.global.name},userTypeRoute:function(t){return t.global.userTypeRoute},token:function(t){return t.global.token}})),mounted:function(){this.parent=this.$parent.$parent.$el,window.addEventListener("scroll",this.handleScroll,!0)},beforeDestroy:function(){this.cancleNotificationsPolling(),window.removeEventListener("scroll",this.handleScroll)},methods:{chooseStrategy:function(t){this.strategy[t.iconfont](t)},axiosNotificationDeatil:function(){return this.$http.get("/notification/list",{params:{page:this.currentPage,page_size:15}})},axiosReadNotification:function(t){return this.$http.post("notification/read",{notification_id:JSON.stringify([t])})},cancleNotificationsPolling:function(){clearInterval(this.notificationTimer)},resetDialog:function(t){this.$refs[t]&&this.$refs[t].resetFields(),this.dialogVisible=!1,this.pwdDialogVisible=!1,this.logoutDialogVisible=!1},modifyPassword:function(){this.pwdDialogVisible=!0,this.pwdDialogTitle="修改密码"},submitModify:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.pwdDialogVisible=!1,e.axiosModify().then((function(t){200===t.data.code&&e.$message({message:"已成功修改密码",type:"success"}),e.pwdDialogVisible=!1}))["catch"]((function(t){console.warn(t)}))["finally"]((function(){Object.keys(e.pwdForm).forEach((function(t){e.pwdForm[t]=""}))}))}))},axiosModify:function(){return this.$http.post("user/reset-passwd",{now_passwd:this.pwdForm.now_passwd,passwd:this.pwdForm.passwd,passwd_repeat:this.pwdForm.passwd_repeat})},logout:function(){this.logoutDialogVisible=!0,this.cancleNotificationsPolling()},routeToDownloadCenter:function(){this.$router.push("/downloadCenter")},subLogout:function(){localStorage.removeItem("smartAdPlatformId"),localStorage.removeItem("FinanceCenterHeader"),this.$store.commit("removeUser"),this.$store.commit("removeRoutes"),this.$router.push("/login")},getNotificationDetail:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.axiosNotificationDeatil();case 2:e=t.sent,200===e.data.code&&(this.messageList=e.data.data.list,this.total=e.data.data.pagination.total);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),resetNotification:function(){this.currentPage=1},currentChange:function(){this.getNotificationDetail()},readNotification:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return window.open("/#/idea"+e.url,"_blank"),t.next=3,this.axiosReadNotification(e.notification_id);case 3:i=t.sent,200===i.data.code&&this.getNotificationDetail();case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleHeaderChange:function(t){this.$router.push({name:t})}}},p=d,f=(i("b671"),i("cba8")),m=Object(f["a"])(p,o,a,!1,null,"6edee289",null);e["default"]=m.exports}}]);